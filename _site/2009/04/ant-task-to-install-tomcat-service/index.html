<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

    <head>
        <title>Bogdan Gusiev's blog</title>
        <meta name="robots" content="follow, all" />
        <link rel="stylesheet" href="/css/default.css" type="text/css" media="screen" />
        <link rel="alternate" type="application/rss+xml" title="Bogdan Gusiev's blog RSS Feed" href="http://feeds.feedburner.com/BogdanGusiev?format=xml" />
        <link rel="shortcut icon" href="/images/favicon.ico"/>
        <title>Ant task to install tomcat service26px</title>

        <link rel="icon" href="/images/favicon.ico"/>


    </head>

    <body>
        <div id="wrapper">

            <div id="header">
                <h1><a href="http://gusiev.com">Bogdan Gusiev's blog</a></h1>
                <h2>How to make your Ruby on Rails application</h4>
            </div> <!-- Closes header -->



            <div id="catnav">
                <div id="toprss">
                    <a href="http://feeds2.feedburner.com/BogdanGusiev?format=xml">
                        <img src="http://gusiev.com/wp-content/themes/pixeled/images/rss-trans.png" alt="Bogdan Gusiev&#8217;s blog" width="65" height="24" />
                    </a>
                </div> <!-- Closes toprss -->
                <ul id="nav">
                    <li><a href="http://gusiev.com">Home</a></li>
                    <li><a href="/?page_id=7">About me</a></li>
                    <li><a href="/?page_id=13">Contacts</a></li>
                </ul>
            </div> <!-- Closes catnav -->

            <div class="clear"></div>

            <div id="main">

                <div id="content">
                    <div id="post">
If you are familiar to run Apache Tomcat as Windows service, you can install it with the ant task. <i>build.xml</i> file sample under the cut line.
<!--more-->
<hr/>
First of all let's do some properties setup:

<div class="bordered">
<code>
catalina.home=d:/java/tomcat-6.0.18
tomcat.executable=${catalina.home}/bin/tomcat6.exe
tomcat.service.executable=\
${catalina.home}/bin/service.bat
tomcat.service.name=myproject
# parameters that will be used in the jvm
tomcat.service.jvm.ms=128
tomcat.service.jvm.mx=256
</code>
</div>
Service startup task consists of 5 exec commands:
<ul>
	<li>Stop service if currently running</li>
	<li>Delete service if installed</li>
	<li>Install service with bat script</li>
	<li>Update service with some parameters</li>
	<li>Start service</li>
</ul>

Here is the implementation:
<div class="bordered">
<code>

    &lt;target name="tomcat.service.install" description="Install tomcat service"&gt;
        
        &lt;exec command="net stop ${tomcat.service.name}"
              failifexecutionfails="false"
              failonerror="false"/&gt;

        &lt;exec command="${tomcat.executable} //DS//${tomcat.service.name}"
              failifexecutionfails="false"
              failonerror="false"/&gt;
        &lt;exec executable="${tomcat.service.executable}" 
                  failifexecutionfails="true" failonerror="true"&gt;
            &lt;env key="CATALINA_HOME" value="${catalina.home}"/&gt;
            &lt;arg value="install"/&gt;
            &lt;arg value="${tomcat.service.name}"/&gt;
        &lt;/exec&gt;
       &lt;exec executable="${tomcat.executable}"&gt;
            &lt;arg value="//US//${tomcat.service.name}"/&gt;
            &lt;arg value="--JvmMs=${jvm.ms}"/&gt;
            &lt;arg value="--JvmMx=${jvm.mx}"/&gt;
            &lt;arg value="--Startup=auto"/&gt;
        &lt;/exec&gt;
        &lt;exec command="net start ${tomcat.service.name}" 
                  failifexecutionfails="true" failonerror="true"/&gt;
    &lt;/target&gt;



</code>
</div>

</div>

<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li><span>28 Apr 2009</span> &raquo; <a href="/2009/04/ant-task-to-install-tomcat-service">Ant task to install tomcat service26px</a></li>
    
      <li><span>05 May 2009</span> &raquo; <a href="/2009/05/what-do-you-expect-from-interface">What do you expect from the interface?</a></li>
    
      <li><span>23 Apr 2009</span> &raquo; <a href="/2009/04/clear-upload-file-input-field">Clear upload file input field </a></li>
    
  </ul>
</div>

                </div>
                    <a href="http://feeds2.feedburner.com/BogdanGusiev?format=xml">
                        <img src="http://gusiev.com/wp-content/themes/pixeled/images/rss-trans.png" alt="Bogdan Gusiev&#8217;s blog" width="65" height="24" />
                    </a>
                </div> <!-- Closes toprss -->
                <div id="sidebars">
                    <div id="welcome">
                        <h2> Welcome to my home page!</h2><p>Feel free to join the discussion by leaving comments, and stay updated by subscribing to the <a href='http://feeds2.feedburner.com/BogdanGusiev?format=xml'>RSS feed</a>.</p>

                    </div><!-- Closes welcome -->
                    <div class="sidebarbox">
                        <h2>Recent Posts</h2>
                        <ul>
                            
                            <li>
                                <a href='/2011/04/javascript-injection-in-json-inserted-directly-into-script-tag'>JavaScript injection in JSON inserted directly into script tag</a>
                            </li>
                            
                            <li>
                                <a href='/2011/03/do-git-commits-associated-to-hoptoad-errors'>Do git commits associated to hoptoad errors</a>
                            </li>
                            
                            <li>
                                <a href='/2011/03/ajax-jquery-debug-javascript'>Debug ajax requests in more easy way</a>
                            </li>
                            
                            <li>
                                <a href='/2010/11/dynamic-context-in-rspec-dont-repeat-yourself'>Dynamic context in Rspec - don't repeat yourself</a>
                            </li>
                            
                            <li>
                                <a href='/2010/09/good-passwords-theory'>Good passwords theory</a>
                            </li>
                            
                        </ul>
                    </div>
                    <div class="sidebarbox">
                        <h2>Search</h2>
                        <p>Use the form below to search the site:</p>
                        <form method="get" id="searchform" action="http://gusiev.com/">
                            <input type="text" value="Search keywords" name="s" id="searchbox" onfocus="this.value=''"/>
                            <input type="submit" class="submitbutton" value="Find it" />
                        </form>	
                    </div>
                    <div class="sidebarbox">
                        <h2>Browse by tags</h2>
                    </div>

                </div><!-- Closes Sidebar_full -->



                <div class="clear"></div>
            </div> <!-- Closes Sidebars -->
            <div class="clear"></div>

        </div><!-- Closes Main -->


        <div id="morefoot">
            <!--LiveInternet counter-->
            <script type="text/javascript">
                document.write("<a href='http://www.liveinternet.ru/click' "+
                        "target=_blank><img src='http://counter.yadro.ru/hit?t40.6;r"+
                        escape(document.referrer)+((typeof(screen)=="undefined")?"":
                            ";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
                                screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
                        ";"+Math.random()+
                        "' alt='' title='LiveInternet' "+
                        "border='0' width='31' height='31'><\/a>");
            </script><!--/LiveInternet-->
            <!--SpyLOG-->
            <span id="spylog2009244"></span><script type="text/javascript"> var spylog = { counter: 2009244, image: 26, next: spylog }; document.write(unescape('%3Cscript src%3D"http' + (('https:' == document.location.protocol) ? 's' : '') + '://counter.spylog.com/cnt.js" defer="defer"%3E%3C/script%3E')); </script>
            <!--SpyLOG-->
            <script type="text/javascript">
                var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
                document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
            </script>
            <script type="text/javascript">
                try {
                    var pageTracker = _gat._getTracker("UA-12663165-1");
                    pageTracker._trackPageview();
                } catch(err) {}</script>
            The Content of this blog can be published anywhere with the link to original source.


        </div><!-- Closes morefoot -->




    </body>
</html>



