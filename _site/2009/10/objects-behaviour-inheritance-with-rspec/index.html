<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

    <head>
        <title>Bogdan Gusiev's blog</title>
        <meta name="robots" content="follow, all" />
        <link rel="stylesheet" href="/css/default.css" type="text/css" media="screen" />
        <link rel="alternate" type="application/rss+xml" title="Bogdan Gusiev's blog RSS Feed" href="http://feeds.feedburner.com/BogdanGusiev?format=xml" />
        <link rel="shortcut icon" href="/images/favicon.ico"/>
        <title>Objects behaviour inheritance with RSpec</title>

        <link rel="icon" href="/images/favicon.ico"/>


    </head>

    <body>
        <div id="wrapper">

            <div id="header">
                <h1><a href="http://gusiev.com">Bogdan Gusiev's blog</a></h1>
                <h2>How to make your Ruby on Rails application</h4>
            </div> <!-- Closes header -->



            <div id="catnav">
                <div id="toprss">
                    <a href="http://feeds2.feedburner.com/BogdanGusiev?format=xml">
                        <img src="http://gusiev.com/wp-content/themes/pixeled/images/rss-trans.png" alt="Bogdan Gusiev&#8217;s blog" width="65" height="24" />
                    </a>
                </div> <!-- Closes toprss -->
                <ul id="nav">
                    <li><a href="http://gusiev.com">Home</a></li>
                    <li><a href="/?page_id=7">About me</a></li>
                    <li><a href="/?page_id=13">Contacts</a></li>
                </ul>
            </div> <!-- Closes catnav -->

            <div class="clear"></div>

            <div id="main">

                <div id="content">
                    <div id="post">
About half of a year ago I was writing about <a href="http://gusiev.com/2009/05/what-do-you-expect-from-interface/">object interface and Liskov Substitution Princeple</a>. In short: Any class instance that extends the base class should pass all <span style="text-decoration: line-through;">unit tests</span> behaviour tests written for base class instance. It was a surprise for me that this concept has already been implemented in RSpec.<br/><br/>

<!--more-->
My previous article was primary inspired by Java programming language and it's interface concept. Unlike Java, Ruby does not have interfaces, but behaviour inheritance is still actual for both languages. RSpec seems the first testing framework that provide the ability to validate LSP and behavior inheritance with 'it_should_behave_like'. <br/>
With Ruby modules(mixins) feature we can build reusable code and include it in different classes<a href="http://ruby-doc.org/core/classes/Module.html">(read more)</a>. With RSpec we can bundle the tests as well.<br/>

<br/>

Let's review the following module that uses one of the Rails callback and adds some logging:<br/>
<pre>
<code>
module LoggedModel
  def after_save
    super
    handle_logging
  end
end
</code>
</pre>
and the some tests group for this module:<br/>
<pre><code>
describe LoggableModel
  it "should be loggable" do
    LoggableModel.should ...
  end
end
</code>
</pre>
Now, we have a tested code that is going to be used in many cases like this:<br/>
<pre><code>class MyModel
  include LoggableModel
  def after_save
    do_some_other_thing
  end
end
</code></pre>

OK, let's see what we have: after_save in MyModel overwrites after_save in LoggableModel and breaks the logging. This is simplest example when the behavior inheritance may be broken. Rspec shared examples groups allows you to ensure that the code in LoggableModel is used correctly from any inherited class. Let's change the definithin of LoggableModel tests.<br/>
<pre><code>
shared_examples_for "logged model" do
  it "should be loggable" do
    subject.should...
  end
end
</code>
</pre>
'Subject' is the ultimate RSpec magic that let us make a simple abstraction with the tested class and reuse these shared examples in MyModel spec:
<pre>
<code>describe MyModel do
  it_should_behave_like 'loggable model'
end</code>
</pre>
In this way we will rerun the LoggableModel examples for MyModel and make sure that it's behavior wasn't broken.

</div>

<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li><span>27 Oct 2009</span> &raquo; <a href="/2009/10/objects-behaviour-inheritance-with-rspec">Objects behaviour inheritance with RSpec</a></li>
    
      <li><span>08 Jun 2010</span> &raquo; <a href="/2010/06/nesting-namespace-route-non-flat-controllers-hierarchy-rails">Advanced non-flat controllers hierarchy with rails</a></li>
    
      <li><span>11 Jul 2010</span> &raquo; <a href="/2010/07/bdd-rspec-matcher-to-test-named_scope-scoped-rails-3">Ultimate rspec matcher to test named_scope or scoped</a></li>
    
  </ul>
</div>

                </div>
                    <a href="http://feeds2.feedburner.com/BogdanGusiev?format=xml">
                        <img src="http://gusiev.com/wp-content/themes/pixeled/images/rss-trans.png" alt="Bogdan Gusiev&#8217;s blog" width="65" height="24" />
                    </a>
                </div> <!-- Closes toprss -->
                <div id="sidebars">
                    <div id="welcome">
                        <h2> Welcome to my home page!</h2><p>Feel free to join the discussion by leaving comments, and stay updated by subscribing to the <a href='http://feeds2.feedburner.com/BogdanGusiev?format=xml'>RSS feed</a>.</p>

                    </div><!-- Closes welcome -->
                    <div class="sidebarbox">
                        <h2>Recent Posts</h2>
                        <ul>
                            
                            <li>
                                <a href='/2011/04/javascript-injection-in-json-inserted-directly-into-script-tag'>JavaScript injection in JSON inserted directly into script tag</a>
                            </li>
                            
                            <li>
                                <a href='/2011/03/do-git-commits-associated-to-hoptoad-errors'>Do git commits associated to hoptoad errors</a>
                            </li>
                            
                            <li>
                                <a href='/2011/03/ajax-jquery-debug-javascript'>Debug ajax requests in more easy way</a>
                            </li>
                            
                            <li>
                                <a href='/2010/11/dynamic-context-in-rspec-dont-repeat-yourself'>Dynamic context in Rspec - don't repeat yourself</a>
                            </li>
                            
                            <li>
                                <a href='/2010/09/good-passwords-theory'>Good passwords theory</a>
                            </li>
                            
                        </ul>
                    </div>
                    <div class="sidebarbox">
                        <h2>Search</h2>
                        <p>Use the form below to search the site:</p>
                        <form method="get" id="searchform" action="http://gusiev.com/">
                            <input type="text" value="Search keywords" name="s" id="searchbox" onfocus="this.value=''"/>
                            <input type="submit" class="submitbutton" value="Find it" />
                        </form>	
                    </div>
                    <div class="sidebarbox">
                        <h2>Browse by tags</h2>
                    </div>

                </div><!-- Closes Sidebar_full -->



                <div class="clear"></div>
            </div> <!-- Closes Sidebars -->
            <div class="clear"></div>

        </div><!-- Closes Main -->


        <div id="morefoot">
            <!--LiveInternet counter-->
            <script type="text/javascript">
                document.write("<a href='http://www.liveinternet.ru/click' "+
                        "target=_blank><img src='http://counter.yadro.ru/hit?t40.6;r"+
                        escape(document.referrer)+((typeof(screen)=="undefined")?"":
                            ";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
                                screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
                        ";"+Math.random()+
                        "' alt='' title='LiveInternet' "+
                        "border='0' width='31' height='31'><\/a>");
            </script><!--/LiveInternet-->
            <!--SpyLOG-->
            <span id="spylog2009244"></span><script type="text/javascript"> var spylog = { counter: 2009244, image: 26, next: spylog }; document.write(unescape('%3Cscript src%3D"http' + (('https:' == document.location.protocol) ? 's' : '') + '://counter.spylog.com/cnt.js" defer="defer"%3E%3C/script%3E')); </script>
            <!--SpyLOG-->
            <script type="text/javascript">
                var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
                document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
            </script>
            <script type="text/javascript">
                try {
                    var pageTracker = _gat._getTracker("UA-12663165-1");
                    pageTracker._trackPageview();
                } catch(err) {}</script>
            The Content of this blog can be published anywhere with the link to original source.


        </div><!-- Closes morefoot -->




    </body>
</html>



